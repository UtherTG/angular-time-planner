!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("angularTimePlanner",[],t):"object"==typeof exports?exports.angularTimePlanner=t():e.angularTimePlanner=t()}(this,function(){return function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(e,t,n){"use strict";e.exports={labels:{rowTitle:"Tasks",counterTitle:{days:"Days",hours:"Hours"},timetableTitle:"Timetable"}}},function(e,t,n){"use strict";angular.module("currentTimeMarkerDirective",[]).directive("currentTimeMarker",["$interval",function(e){return{restrict:"E",link:function(t,n){function a(){var e=void 0,t=void 0;c=(e=document.querySelector(".atp-items-wrapper .atp-segment"))?e.offsetLeft:0,u=(t=document.querySelector(".atp-items-wrapper"))?t.offsetWidth:0,f=u-c,n.css({left:c+"px"}),r()}function r(){var e=c+o();n.css({left:e+"px",opacity:c===e?0:1})}function o(){switch(t.options.timeScope){case"day":return i();case"week":return s();case"month":case"range":return 0}}function i(){var e=new Date,t=e.getHours(),n=Math.floor(e.getMinutes()/15);return f/24*(t+.25*(n>0?n:0))}function s(){var e=new Date,t=e.getDay(),n=Math.floor(e.getHours()/6);return f/7*(t+.25*(n>0?n:0))}function l(){e.cancel(d)}var d=void 0,c=void 0,u=void 0,f=void 0;angular.element(a),t.$watch("options.timeScope",r),function(){d=e(function(){r()},6e4)}(),n.on("$destroy",l)},template:"<div></div>"}}])},function(e,t,n){"use strict";var a=n(12),r=function(e){return e&&e.__esModule?e:{default:e}}(a);angular.module("timePlannerCellDirective",[]).directive("timePlannerCell",["$rootScope",function(e){var t=["$scope",function(t){t.onHoverEvent=function(e){t.$parent.highlightedItem=e},t.onClickEvent=function(t){return e.$broadcast("ATP_SEGMENT_ON_CLICK",t)}}];return{restrict:"A",template:r.default,controller:t}}])},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=n(13),i=a(o),s=n(11),l=a(s);n(9),angular.module("timePlannerContainerDirective",["ang-drag-drop","timeSegment","currentTimeMarkerDirective"]).directive("timePlannerContainer",["$rootScope","$locale","LOCALES",function(e,t,a){return{restrict:"E",scope:{options:"=",rows:"="},controller:["$scope","TimeSegment",function(o,i){function s(){o.options=(0,l.default)(g,o.options),o.locale=(0,l.default)(n(15)("./time-planner-locale_"+p),o.options.locale||{}),o.segments=d()}function d(){switch(o.options.timeScope){case"day":return c();case"range":break;case"month":return u();case"week":default:return f()}}function c(){for(var e=[],t=0;t<24;t++)e.push(new i({name:t,segmentType:"hour",disableTimetable:!0}));return e}function u(){for(var e=[],t=new Date(o.options.from),n=t.getMonth()+1,a=new Date(t.getFullYear(),n,0).getDate(),r=1;r<=a;r++)e.push(new i({name:(r<10?"0"+r:r)+"."+n,segmentType:"month-day",disableTimetable:!0}));return e}function f(){var e=[].concat(r(t.DATETIME_FORMATS.SHORTDAY)),n=e.splice(o.options.firstDay||0,e.length),a=[].concat(r(n),r(e)),s=[];return a.forEach(function(e){s.push(new i({name:e,segmentType:"week-day",disableTimetable:!0}))}),s}var p=a.AVAILABLE.includes(t.id)?t.id:a.DEFAULT,g={timeScope:"week",editable:!1,dropChannel:"atp-row"};o.$watchCollection("options",s),o.onDropEvent=function(t,n){return e.$broadcast("ATP_ITEM_ON_DROP",{id:n,item:t})}}],template:i.default}}])},function(e,t,n){"use strict";var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=n(14),o=function(e){return e&&e.__esModule?e:{default:e}}(r);angular.module("timePlannerRowDirective",["timeSegment","timetable"]).directive("timePlannerRow",function(){var e=["$scope","TimeSegment","Timetable",function(e,t,n){function r(){e.row.segments=[],e.row.hours=0,e.row.disableTimetable="month"===e.options.timeScope,e.$parent.segments.forEach(function(r,o){var i=new t(a({},r,{range:u[e.options.timeScope].setRange(o)}));e.row.disableTimetable||(i.timetable=e.row.timetable&&new n(e.row.timetable),i.toggleDisabled(!i.timetable||!i.timetable.validate(i.range))),e.row.segments.push(i)}),e.row.items.forEach(u[e.options.timeScope].fillSegments)}function o(t){var n=new Date(e.options.from),a=new Date(e.options.to),r=n.getDate();return n=n.setDate(r+t),a=a.setDate(r+t),[n,a]}function i(t){var n=new Date(e.$parent.options.from),a=new Date(e.$parent.options.to);return n=n.setHours(t),a=a.setHours(t),[n,a]}function s(t){var n={scheduledStart:new Date(t.scheduled_start),scheduledEnd:new Date(t.scheduled_end)},a=void 0,r=void 0;n.scheduledStart.setHours(0,0,0,0),n.scheduledEnd.setHours(23,59,59,999),n=c(n),r=n.scheduledStart.getDate()-1,a=Math.ceil(Math.abs((n.scheduledStart.getTime()-n.scheduledEnd.getTime())/864e5));for(var o=0;o<a;o++)e.row.segments[r+o].disabled||(e.row.segments[r+o].addItem(t),e.options.disableCounter||(e.row.hours+=8))}function l(t){var n={scheduledStart:new Date(t.scheduled_start),scheduledEnd:new Date(t.scheduled_end)},a=void 0,r=void 0;n.scheduledStart.setHours(0,0,0,0),n.scheduledEnd.setHours(23,59,59,999),n=c(n),r=n.scheduledStart.getDay(),a=Math.ceil(Math.abs((n.scheduledStart.getTime()-n.scheduledEnd.getTime())/864e5));for(var o=0;o<a;o++)e.row.segments[r+o].disabled||(e.row.segments[r+o].addItem(t),e.options.disableCounter||(e.row.hours+=8))}function d(t){var n={scheduledStart:new Date(t.scheduled_start),scheduledEnd:new Date(t.scheduled_end)},a=void 0,r=void 0,o=void 0;n=c(n),r=n.scheduledStart.getHours(),o=n.scheduledStart.getHours()>n.scheduledEnd.getHours(),a=(o?24:n.scheduledEnd.getHours())-n.scheduledStart.getHours(),a+=0===n.scheduledEnd.getMinutes()?0:1;for(var i=0;i<a;i++)e.row.segments[r+i].disabled||(e.row.segments[r+i].addItem(t),e.options.disableCounter||e.row.hours++)}function c(t){return t.scheduledStart=t.scheduledStart.getTime()<e.$parent.options.from.getTime()?e.$parent.options.from:t.scheduledStart,t.scheduledEnd=t.scheduledEnd.getTime()>e.$parent.options.to.getTime()?e.$parent.options.to:t.scheduledEnd,t.scheduledStart.getTime()>t.scheduledEnd.getTime()&&(t.scheduledStart=t.scheduledEnd),t}var u={week:{fillSegments:l,setRange:o},day:{fillSegments:d,setRange:i},month:{fillSegments:s,setRange:o}};e.$watchCollection("options",r)}];return{restrict:"A",template:o.default,controller:e}})},function(e,t,n){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();angular.module("timeSegment",[]).factory("TimeSegment",[function(){return function(){function e(t){r(this,e),this.name=t.name,this.segmentType=t.segmentType,this.items=t.items||[],this.range=t.range||[],this.disabled=t.disabled||!1}return o(e,[{key:"addItem",value:function(e){this.items=[].concat(a(this.items),[e])}},{key:"removeItem",value:function(e){this.items=this.items.filter(function(t){return t.id!==e.id})}},{key:"toggleDisabled",value:function(e){this.disabled=void 0===e?!this.disabled:e}}]),e}()}])},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();angular.module("timetable",[]).factory("Timetable",[function(){return function(){function e(t){a(this,e),this.start=[Number(t.start[0]),Number(t.start[1])],this.end=[Number(t.end[0]),Number(t.end[1])],this.breakStart=t.breakStart,this.breakEnd=t.breakEnd,this.weekAvailability=t.weekAvailability}return r(e,[{key:"validate",value:function(e){var t=new Date(e[0]),n=new Date(e[1]),a=t.getDay(),r=t.getHours(),o=n.getHours(),i=this.start[0]>this.end[0];return r===o?this.weekAvailability[a]&&(i?r>=this.start[0]&&o<24||r>=0&&o<this.end[0]:r>=this.start[0]&&o<this.end[0]):this.weekAvailability[a]}}]),e}()}])},function(e,t){},function(e,t){!function(e){"use strict";function t(e){e.originalEvent&&(e.dataTransfer=e.originalEvent.dataTransfer),void 0!==e.dataTransfer&&"none"===e.dataTransfer.dropEffect&&("copy"===e.dataTransfer.effectAllowed||"move"===e.dataTransfer.effectAllowed?e.dataTransfer.dropEffect=e.dataTransfer.effectAllowed:"copyMove"!==e.dataTransfer.effectAllowed&&"copymove"!==e.dataTransfer.effectAllowed||(e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move"))}if(!function(){return"ondrag"in document.createElement("a")}())return void e.module("ang-drag-drop",[]);var n=e.module("ang-drag-drop",[]);n.directive("uiDraggable",["$parse","$rootScope","$dragImage",function(n,a,r){return function(o,i,s){function l(e){e.originalEvent&&(e.dataTransfer=e.originalEvent.dataTransfer),setTimeout(function(){i.unbind("$destroy",l)},0);var r=s.dragChannel||"defaultchannel";if(a.$broadcast("ANGULAR_DRAG_END",e,r),t(e),e.dataTransfer&&"none"!==e.dataTransfer.dropEffect){if(s.onDropSuccess){var d=n(s.onDropSuccess);o.$evalAsync(function(){d(o,{$event:e})})}}else if(e.dataTransfer&&"none"===e.dataTransfer.dropEffect&&s.onDropFailure){var c=n(s.onDropFailure);o.$evalAsync(function(){c(o,{$event:e})})}i.removeClass(g)}function d(t,a){var r;t.originalEvent&&(t.dataTransfer=t.originalEvent.dataTransfer),r=n(a),o.$apply(function(){var n,a=r(o,{$event:t});a&&e.isString(a)&&(n=document.getElementById(a))&&t.dataTransfer.setDragImage(n,0,0)})}function c(t){if(t.originalEvent&&(t.dataTransfer=t.originalEvent.dataTransfer),!p||f.classList.contains(u)){var c=s.dragChannel||"defaultchannel",m="";s.drag&&(m=o.$eval(s.drag));var v=s.dragImage||null;i.addClass(g),i.bind("$destroy",l);var h=!(document.uniqueID||window.opera);if(v&&h){var b=n(s.dragImage);o.$apply(function(){var n=b(o,{$event:t});if(n&&(e.isString(n)&&(n=r.generate(n)),n.image)){var a=n.xOffset||0,i=n.yOffset||0;t.dataTransfer.setDragImage(n.image,a,i)}})}else s.dragImageElementId&&d(t,s.dragImageElementId);var y={x:t.offsetX,y:t.offsetY},w={data:m,channel:c,offset:y},T=e.toJson(w);t.dataTransfer.setData("text",T),t.dataTransfer.effectAllowed="copyMove",a.$broadcast("ANGULAR_DRAG_START",t,c,w)}else t.preventDefault()}var u,f,p=!1,g=s.draggingClass||"on-dragging";i.attr("draggable",!1),o.$watch(s.uiDraggable,function(e){e?(i.attr("draggable",e),i.bind("dragend",l),i.bind("dragstart",c)):(i.removeAttr("draggable"),i.unbind("dragend",l),i.unbind("dragstart",c))}),e.isString(s.dragHandleClass)&&(p=!0,u=s.dragHandleClass.trim()||"drag-handle",i.bind("mousedown",function(e){f=e.target}))}}]),n.directive("uiOnDrop",["$parse","$rootScope",function(n,a){return function(r,o,i){function s(e){for(var t={x:e.offsetX,y:e.offsetY},n=e.target;n!==o[0];)if(t.x=t.x+n.offsetLeft,t.y=t.y+n.offsetTop,!(n=n.offsetParent))return null;return t}function l(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation();var t=n(i.uiOnDragOver);return r.$evalAsync(function(){t(r,{$event:e,$channel:m})}),!1}function d(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),0===--g&&(r.$evalAsync(function(){w(r,{$event:e,$channel:m})}),o.addClass(h),o.removeClass(b));var t=n(i.uiOnDragLeave);r.$evalAsync(function(){t(r,{$event:e,$channel:m})})}function c(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),0===g&&(r.$evalAsync(function(){y(r,{$event:e,$channel:m})}),o.removeClass(h),o.addClass(b)),g++;var t=n(i.uiOnDragEnter);r.$evalAsync(function(){t(r,{$event:e,$channel:m})}),a.$broadcast("ANGULAR_HOVER",v)}function u(a){a.originalEvent&&(a.dataTransfer=a.originalEvent.dataTransfer),a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation();var l=a.dataTransfer.getData("text");l=e.fromJson(l);var d=s(a),c=d?{x:d.x-l.offset.x,y:d.y-l.offset.y}:null;t(a);var u=n(i.uiOnDrop);r.$evalAsync(function(){u(r,{$data:l.data,$event:a,$channel:l.channel,$position:c})}),o.removeClass(h),g=0}function f(e,t){return"*"===t||new RegExp("(\\s|[,])+("+e+")(\\s|[,])+","i").test(","+t+",")}function p(e){return e.originalEvent&&(e.dataTransfer=e.originalEvent.dataTransfer),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.dataTransfer.dropEffect="none",!1}var g=0,m=i.dropChannel||"defaultchannel",v="",h=i.dragEnterClass||"on-drag-enter",b=i.dragHoverClass||"on-drag-hover",y=n(i.onDragEnter),w=n(i.onDragLeave),T=a.$on("ANGULAR_DRAG_START",function(e,t,a,s){v=a;var g=!0;if(f(a,m)||(g=!1),g&&i.dropValidate){g=n(i.dropValidate)(r,{$drop:{scope:r,element:o},$event:t,$data:s.data,$channel:s.channel})}g?(o.bind("dragover",l),o.bind("dragenter",c),o.bind("dragleave",d),o.bind("drop",u),o.addClass(h)):(o.bind("dragover",p),o.bind("dragenter",p),o.bind("dragleave",p),o.bind("drop",p),o.removeClass(h))}),D=a.$on("ANGULAR_DRAG_END",function(){o.unbind("dragover",l),o.unbind("dragenter",c),o.unbind("dragleave",d),o.unbind("drop",u),o.removeClass(b),o.removeClass(h),o.unbind("dragover",p),o.unbind("dragenter",p),o.unbind("dragleave",p),o.unbind("drop",p)});r.$on("$destroy",function(){T(),D()}),i.$observe("dropChannel",function(e){e&&(m=e)})}}]),n.constant("$dragImageConfig",{height:20,width:200,padding:10,font:"bold 11px Arial",fontColor:"#eee8d5",backgroundColor:"#93a1a1",xOffset:0,yOffset:0}),n.service("$dragImage",["$dragImageConfig",function(t){function n(e,t,n){var r=e.measureText(t).width;if(r<n.width)return t;for(;r+n.padding>n.width;)t=t.substring(0,t.length-1),r=e.measureText(t+a).width;return t+a}var a="â€¦";this.generate=function(a,r){var o=e.extend({},t,r||{}),i=document.createElement("canvas");i.height=o.height,i.width=o.width;var s=i.getContext("2d");s.fillStyle=o.backgroundColor,s.fillRect(0,0,o.width,o.height),s.font=o.font,s.fillStyle=o.fontColor;var l=n(s,a,o);s.fillText(l,4,o.padding+4);var d=new Image;return d.src=i.toDataURL(),{image:d,xOffset:o.xOffset,yOffset:o.yOffset}}}])}(angular)},function(e,t,n){n(8),e.exports="ang-drag-drop"},function(e,t,n){"use strict";n(3),n(4),n(2),n(5),n(6),n(1),n(7),angular.module("angularTimePlanner",["timePlannerContainerDirective","timePlannerRowDirective","timePlannerCellDirective"]).constant("LOCALES",{DEFAULT:"en-us",AVAILABLE:["en-us"]})},function(e,t,n){"use strict";function a(e){return!!e&&"object"==typeof e}function r(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||o(e)}function o(e){return e.$$typeof===p}function i(e){return Array.isArray(e)?[]:{}}function s(e,t){return t&&!0===t.clone&&u(e)?c(i(e),e,t):e}function l(e,t,n){var a=e.slice();return t.forEach(function(t,r){void 0===a[r]?a[r]=s(t,n):u(t)?a[r]=c(e[r],t,n):-1===e.indexOf(t)&&a.push(s(t,n))}),a}function d(e,t,n){var a={};return u(e)&&Object.keys(e).forEach(function(t){a[t]=s(e[t],n)}),Object.keys(t).forEach(function(r){u(t[r])&&e[r]?a[r]=c(e[r],t[r],n):a[r]=s(t[r],n)}),a}function c(e,t,n){var a=Array.isArray(t),r=Array.isArray(e),o=n||{arrayMerge:l};if(a===r)return a?(o.arrayMerge||l)(e,t,n):d(e,t,n);return s(t,n)}var u=function(e){return a(e)&&!r(e)},f="function"==typeof Symbol&&Symbol.for,p=f?Symbol.for("react.element"):60103;c.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,n){return c(e,n,t)})};var g=c;e.exports=g},function(e,t){e.exports='<div class=atp-segment-item-wrapper><div class=atp-segment-item ng-repeat="item in segment.items" ng-class="[item.segmentType, {\'highlighted\': (item.id === highlightedItem.id)}]" ng-mouseenter=onHoverEvent(item) ng-mouseleave=onHoverEvent() ng-click=onClickEvent(item)></div></div>'},function(e,t){e.exports='<div class=atp-container><div class=atp-head><div class=atp-row><div class="atp-cell atpr-title"><span class=atpc-label>{{locale.labels.rowTitle}}</span></div><div class="atp-cell atpr-timetable" ng-if=!options.disableTimetable><span class=atpc-label>{{locale.labels.timetableTitle}}</span></div><div class="atp-cell atpr-counter" ng-if=!options.disableCounter><span class=atpc-label>{{locale.labels.counterTitle.hours}}</span></div><div class="atp-cell atp-segment" ng-repeat="segment in segments" ng-class="{\'week-day-segment\': options.timeScope === \'week\',\n                      \'month-day-segment\': options.timeScope === \'month\',\n                      \'hour-segment\': options.timeScope === \'day\'}"><span class=atpc-label>{{segment.name}}</span></div></div></div><div class=atp-items-wrapper><div class=atp-row ng-repeat="row in rows" drop-channel="{{options.editable && row.editable && options.dropChannel}}" ui-on-drop="onDropEvent($data, row.id)" time-planner-row></div><current-time-marker class=atp-current-time-marker ng-if=!options.disableCurrentTimeMarker /></div></div>'},function(e,t){e.exports="<div class=\"atp-cell atpr-title\"><span class=atpc-label>{{row.title}}</span></div><div class=\"atp-cell atpr-timetable\" ng-if=!options.disableTimetable><span class=atpc-label>{{row.timetable.start ? row.timetable.start.join(':') + \" - \" + row.timetable.end.join(':') : 'N/A'}}</span></div><div class=\"atp-cell atpr-counter\" ng-if=!options.disableCounter><span class=atpc-label>{{row.hours || 0}}</span></div><div class=\"atp-cell atp-segment\" ng-repeat=\"segment in row.segments\" ng-class=\"{'week-day-segment': options.timeScope === 'week',\n                'hour-segment': options.timeScope === 'day',\n                'month-day-segment': options.timeScope === 'month',\n                'unavailable-segment': segment.disabled}\" time-planner-cell></div>"},function(e,t,n){function a(e){return n(r(e))}function r(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var o={"./time-planner-locale_en-us":0,"./time-planner-locale_en-us.js":0};a.keys=function(){return Object.keys(o)},a.resolve=r,e.exports=a,a.id=15}])});
//# sourceMappingURL=angular-time-planner.min.js.map