!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("angularTimePlanner",[],t):"object"==typeof exports?exports.angularTimePlanner=t():e.angularTimePlanner=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=10)}([function(e,t,n){"use strict";e.exports={labels:{rowTitle:"Tasks",counterTitle:{days:"Days",hours:"Hours"},timetableTitle:"Timetable"}}},function(e,t,n){"use strict";angular.module("currentTimeMarkerDirective",[]).directive("currentTimeMarker",["$interval",function(e){return{restrict:"E",link:function(t,n){function r(){var e=void 0,t=void 0;c=(e=document.querySelector(".atp-items-wrapper .atp-segment"))?e.offsetLeft:0,d=(t=document.querySelector(".atp-items-wrapper"))?t.offsetWidth:0,u=d-c,n.css({left:c+"px"}),a()}function a(){var e=c+o();n.css({left:e+"px",opacity:e?1:0})}function o(){switch(t.options.timeScope){case"day":return i();case"week":return s();case"range":return 0}}function i(){var e=new Date,t=e.getHours(),n=Math.floor(e.getMinutes()/15);return u/24*(t+.25*(n>0?n:0))}function s(){var e=new Date,t=e.getDay(),n=Math.floor(e.getHours()/6);return u/7*(t+.25*(n>0?n:0))}var l=void 0,c=void 0,d=void 0,u=void 0;angular.element(r),t.$watch("options.timeScope",a),l=e(function(){a()},6e4),n.on("$destroy",function(){e.cancel(l)})},template:"<div></div>"}}])},function(e,t,n){"use strict";var r=n(12),a=function(e){return e&&e.__esModule?e:{default:e}}(r);angular.module("timePlannerCellDirective",[]).directive("timePlannerCell",["$rootScope",function(e){var t=["$scope",function(t){t.onHoverEvent=function(e){t.$parent.highlightedItem=e},t.onClickEvent=function(t){return e.$broadcast("ATP_SEGMENT_ON_CLICK",t)}}];return{restrict:"A",template:a.default,controller:t}}])},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=n(13),i=r(o),s=n(11),l=r(s);n(9),angular.module("timePlannerContainerDirective",["ang-drag-drop","timeSegment","currentTimeMarkerDirective"]).directive("timePlannerContainer",["$rootScope","$locale","LOCALES",function(e,t,r){return{restrict:"E",scope:{options:"=",rows:"="},controller:["$scope","TimeSegment",function(o,i){function s(){o.options=(0,l.default)(p,o.options),o.locale=(0,l.default)(n(15)("./time-planner-locale_"+f),o.options.locale||{}),o.segments=c()}function c(){switch(o.options.timeScope){case"day":return d();case"range":break;case"week":default:return u()}}function d(){for(var e=[],t=0;t<24;t++)e.push(new i({name:t,segmentType:"hour",disableTimetable:!0}));return e}function u(){var e=[].concat(a(t.DATETIME_FORMATS.SHORTDAY)),n=e.splice(o.options.firstDay||0,e.length),r=[].concat(a(n),a(e)),s=[];return r.forEach(function(e){s.push(new i({name:e,segmentType:"week-day",disableTimetable:!0}))}),s}var f=r.AVAILABLE.includes(t.id)?t.id:r.DEFAULT,p={timeScope:"week",disableCounter:!0,editable:!1,dropChannel:"atp-row"};o.$watchCollection("options",s),o.onDropEvent=function(t,n){return e.$broadcast("ATP_ITEM_ON_DROP",{id:n,item:t})}}],template:i.default}}])},function(e,t,n){"use strict";var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=n(14),o=function(e){return e&&e.__esModule?e:{default:e}}(a);angular.module("timePlannerRowDirective",["timeSegment","timetable"]).directive("timePlannerRow",function(){var e=["$scope","TimeSegment","Timetable",function(e,t,n){function a(){e.row.segments=[],e.row.hours=0,e.$parent.segments.forEach(function(a,o){var i=new t(r({},a,{range:d[e.options.timeScope].setRange(o)}));e.row.disableTimetable||(i.timetable=e.row.timetable&&new n(e.row.timetable),i.toggleDisabled(!i.timetable||!i.timetable.validate(i.range))),e.row.segments.push(i)}),e.row.items.forEach(d[e.options.timeScope].fillSegments)}function o(t){var n=new Date(e.options.from),r=new Date(e.options.to),a=n.getDate();return n=n.setDate(a+t),r=r.setDate(a+t),[n,r]}function i(t){var n=new Date(e.$parent.options.from),r=new Date(e.$parent.options.to);return n=n.setHours(t),r=r.setHours(t),[n,r]}function s(t){var n={scheduledStart:new Date(t.scheduled_start),scheduledEnd:new Date(t.scheduled_end)},r=void 0,a=void 0;n.scheduledStart.setHours(0,0,0,0),n.scheduledEnd.setHours(23,59,59,999),n=c(n),a=n.scheduledStart.getDay(),r=Math.ceil(Math.abs((n.scheduledStart.getTime()-n.scheduledEnd.getTime())/864e5)),e.options.disableCounter||(e.row.hours+=8*r);for(var o=0;o<r;o++)!e.row.segments[a+o].disabled&&e.row.segments[a+o].addItem(t)}function l(t){var n={scheduledStart:new Date(t.scheduled_start),scheduledEnd:new Date(t.scheduled_end)},r=void 0,a=void 0,o=void 0;n=c(n),a=n.scheduledStart.getHours(),o=n.scheduledStart.getHours()>n.scheduledEnd.getHours(),r=(o?24:n.scheduledEnd.getHours())-n.scheduledStart.getHours(),r+=0===n.scheduledEnd.getMinutes()?0:1,e.options.disableCounter||(e.row.hours+=r);for(var i=0;i<r;i++)!e.row.segments[a+i].disabled&&e.row.segments[a+i].addItem(t)}function c(t){return t.scheduledStart=t.scheduledStart<e.$parent.options.from?e.$parent.options.from:t.scheduledStart,t.scheduledEnd=t.scheduledEnd>e.$parent.options.to?e.$parent.options.to:t.scheduledEnd,t}var d={week:{fillSegments:s,setRange:o},day:{fillSegments:l,setRange:i}};e.$watchCollection("options",a)}];return{restrict:"A",template:o.default,controller:e}})},function(e,t,n){"use strict";function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();angular.module("timeSegment",[]).factory("TimeSegment",[function(){return function(){function e(t){a(this,e),this.name=t.name,this.segmentType=t.segmentType,this.items=t.items||[],this.range=t.range||[],this.disabled=t.disabled||!1}return o(e,[{key:"addItem",value:function(e){this.items=[].concat(r(this.items),[e])}},{key:"removeItem",value:function(e){this.items=this.items.filter(function(t){return t.id!==e.id})}},{key:"toggleDisabled",value:function(e){this.disabled=void 0===e?!this.disabled:e}}]),e}()}])},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();angular.module("timetable",[]).factory("Timetable",[function(){return function(){function e(t){r(this,e),this.start=[Number(t.start[0]),Number(t.start[1])],this.end=[Number(t.end[0]),Number(t.end[1])],this.breakStart=t.breakStart,this.breakEnd=t.breakEnd,this.weekAvailability=t.weekAvailability}return a(e,[{key:"validate",value:function(e){var t=new Date(e[0]),n=new Date(e[1]),r=t.getDay(),a=t.getHours(),o=n.getHours(),i=this.start[0]>this.end[0];return a===o?this.weekAvailability[r]&&(i?a>=this.start[0]&&o<24||a>=0&&o<this.end[0]:a>=this.start[0]&&o<this.end[0]):this.weekAvailability[r]}}]),e}()}])},function(e,t){},function(e,t){!function(e){"use strict";function t(e){e.originalEvent&&(e.dataTransfer=e.originalEvent.dataTransfer),void 0!==e.dataTransfer&&"none"===e.dataTransfer.dropEffect&&("copy"===e.dataTransfer.effectAllowed||"move"===e.dataTransfer.effectAllowed?e.dataTransfer.dropEffect=e.dataTransfer.effectAllowed:"copyMove"!==e.dataTransfer.effectAllowed&&"copymove"!==e.dataTransfer.effectAllowed||(e.dataTransfer.dropEffect=e.ctrlKey?"copy":"move"))}if(!function(){return"ondrag"in document.createElement("a")}())return void e.module("ang-drag-drop",[]);var n=e.module("ang-drag-drop",[]);n.directive("uiDraggable",["$parse","$rootScope","$dragImage",function(n,r,a){return function(o,i,s){function l(e){e.originalEvent&&(e.dataTransfer=e.originalEvent.dataTransfer),setTimeout(function(){i.unbind("$destroy",l)},0);var a=s.dragChannel||"defaultchannel";if(r.$broadcast("ANGULAR_DRAG_END",e,a),t(e),e.dataTransfer&&"none"!==e.dataTransfer.dropEffect){if(s.onDropSuccess){var c=n(s.onDropSuccess);o.$evalAsync(function(){c(o,{$event:e})})}}else if(e.dataTransfer&&"none"===e.dataTransfer.dropEffect&&s.onDropFailure){var d=n(s.onDropFailure);o.$evalAsync(function(){d(o,{$event:e})})}i.removeClass(g)}function c(t,r){var a;t.originalEvent&&(t.dataTransfer=t.originalEvent.dataTransfer),a=n(r),o.$apply(function(){var n,r=a(o,{$event:t});r&&e.isString(r)&&(n=document.getElementById(r))&&t.dataTransfer.setDragImage(n,0,0)})}function d(t){if(t.originalEvent&&(t.dataTransfer=t.originalEvent.dataTransfer),!p||f.classList.contains(u)){var d=s.dragChannel||"defaultchannel",v="";s.drag&&(v=o.$eval(s.drag));var m=s.dragImage||null;i.addClass(g),i.bind("$destroy",l);var h=!(document.uniqueID||window.opera);if(m&&h){var b=n(s.dragImage);o.$apply(function(){var n=b(o,{$event:t});if(n&&(e.isString(n)&&(n=a.generate(n)),n.image)){var r=n.xOffset||0,i=n.yOffset||0;t.dataTransfer.setDragImage(n.image,r,i)}})}else s.dragImageElementId&&c(t,s.dragImageElementId);var y={x:t.offsetX,y:t.offsetY},w={data:v,channel:d,offset:y},T=e.toJson(w);t.dataTransfer.setData("text",T),t.dataTransfer.effectAllowed="copyMove",r.$broadcast("ANGULAR_DRAG_START",t,d,w)}else t.preventDefault()}var u,f,p=!1,g=s.draggingClass||"on-dragging";i.attr("draggable",!1),o.$watch(s.uiDraggable,function(e){e?(i.attr("draggable",e),i.bind("dragend",l),i.bind("dragstart",d)):(i.removeAttr("draggable"),i.unbind("dragend",l),i.unbind("dragstart",d))}),e.isString(s.dragHandleClass)&&(p=!0,u=s.dragHandleClass.trim()||"drag-handle",i.bind("mousedown",function(e){f=e.target}))}}]),n.directive("uiOnDrop",["$parse","$rootScope",function(n,r){return function(a,o,i){function s(e){for(var t={x:e.offsetX,y:e.offsetY},n=e.target;n!==o[0];)if(t.x=t.x+n.offsetLeft,t.y=t.y+n.offsetTop,!(n=n.offsetParent))return null;return t}function l(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation();var t=n(i.uiOnDragOver);return a.$evalAsync(function(){t(a,{$event:e,$channel:v})}),!1}function c(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),0===--g&&(a.$evalAsync(function(){w(a,{$event:e,$channel:v})}),o.addClass(h),o.removeClass(b));var t=n(i.uiOnDragLeave);a.$evalAsync(function(){t(a,{$event:e,$channel:v})})}function d(e){e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),0===g&&(a.$evalAsync(function(){y(a,{$event:e,$channel:v})}),o.removeClass(h),o.addClass(b)),g++;var t=n(i.uiOnDragEnter);a.$evalAsync(function(){t(a,{$event:e,$channel:v})}),r.$broadcast("ANGULAR_HOVER",m)}function u(r){r.originalEvent&&(r.dataTransfer=r.originalEvent.dataTransfer),r.preventDefault&&r.preventDefault(),r.stopPropagation&&r.stopPropagation();var l=r.dataTransfer.getData("text");l=e.fromJson(l);var c=s(r),d=c?{x:c.x-l.offset.x,y:c.y-l.offset.y}:null;t(r);var u=n(i.uiOnDrop);a.$evalAsync(function(){u(a,{$data:l.data,$event:r,$channel:l.channel,$position:d})}),o.removeClass(h),g=0}function f(e,t){return"*"===t||new RegExp("(\\s|[,])+("+e+")(\\s|[,])+","i").test(","+t+",")}function p(e){return e.originalEvent&&(e.dataTransfer=e.originalEvent.dataTransfer),e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.dataTransfer.dropEffect="none",!1}var g=0,v=i.dropChannel||"defaultchannel",m="",h=i.dragEnterClass||"on-drag-enter",b=i.dragHoverClass||"on-drag-hover",y=n(i.onDragEnter),w=n(i.onDragLeave),T=r.$on("ANGULAR_DRAG_START",function(e,t,r,s){m=r;var g=!0;if(f(r,v)||(g=!1),g&&i.dropValidate){g=n(i.dropValidate)(a,{$drop:{scope:a,element:o},$event:t,$data:s.data,$channel:s.channel})}g?(o.bind("dragover",l),o.bind("dragenter",d),o.bind("dragleave",c),o.bind("drop",u),o.addClass(h)):(o.bind("dragover",p),o.bind("dragenter",p),o.bind("dragleave",p),o.bind("drop",p),o.removeClass(h))}),$=r.$on("ANGULAR_DRAG_END",function(){o.unbind("dragover",l),o.unbind("dragenter",d),o.unbind("dragleave",c),o.unbind("drop",u),o.removeClass(b),o.removeClass(h),o.unbind("dragover",p),o.unbind("dragenter",p),o.unbind("dragleave",p),o.unbind("drop",p)});a.$on("$destroy",function(){T(),$()}),i.$observe("dropChannel",function(e){e&&(v=e)})}}]),n.constant("$dragImageConfig",{height:20,width:200,padding:10,font:"bold 11px Arial",fontColor:"#eee8d5",backgroundColor:"#93a1a1",xOffset:0,yOffset:0}),n.service("$dragImage",["$dragImageConfig",function(t){function n(e,t,n){var a=e.measureText(t).width;if(a<n.width)return t;for(;a+n.padding>n.width;)t=t.substring(0,t.length-1),a=e.measureText(t+r).width;return t+r}var r="â€¦";this.generate=function(r,a){var o=e.extend({},t,a||{}),i=document.createElement("canvas");i.height=o.height,i.width=o.width;var s=i.getContext("2d");s.fillStyle=o.backgroundColor,s.fillRect(0,0,o.width,o.height),s.font=o.font,s.fillStyle=o.fontColor;var l=n(s,r,o);s.fillText(l,4,o.padding+4);var c=new Image;return c.src=i.toDataURL(),{image:c,xOffset:o.xOffset,yOffset:o.yOffset}}}])}(angular)},function(e,t,n){n(8),e.exports="ang-drag-drop"},function(e,t,n){"use strict";n(3),n(4),n(2),n(5),n(6),n(1),n(7),angular.module("angularTimePlanner",["timePlannerContainerDirective","timePlannerRowDirective","timePlannerCellDirective"]).constant("LOCALES",{DEFAULT:"en-us",AVAILABLE:["en-us"]})},function(e,t,n){"use strict";function r(e){return!!e&&"object"==typeof e}function a(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||o(e)}function o(e){return e.$$typeof===p}function i(e){return Array.isArray(e)?[]:{}}function s(e,t){return t&&!0===t.clone&&u(e)?d(i(e),e,t):e}function l(e,t,n){var r=e.slice();return t.forEach(function(t,a){void 0===r[a]?r[a]=s(t,n):u(t)?r[a]=d(e[a],t,n):-1===e.indexOf(t)&&r.push(s(t,n))}),r}function c(e,t,n){var r={};return u(e)&&Object.keys(e).forEach(function(t){r[t]=s(e[t],n)}),Object.keys(t).forEach(function(a){u(t[a])&&e[a]?r[a]=d(e[a],t[a],n):r[a]=s(t[a],n)}),r}function d(e,t,n){var r=Array.isArray(t),a=Array.isArray(e),o=n||{arrayMerge:l};if(r===a)return r?(o.arrayMerge||l)(e,t,n):c(e,t,n);return s(t,n)}var u=function(e){return r(e)&&!a(e)},f="function"==typeof Symbol&&Symbol.for,p=f?Symbol.for("react.element"):60103;d.all=function(e,t){if(!Array.isArray(e)||e.length<2)throw new Error("first argument should be an array with at least two elements");return e.reduce(function(e,n){return d(e,n,t)})};var g=d;e.exports=g},function(e,t){e.exports='<div class=atp-segment-item-wrapper><div class=atp-segment-item ng-repeat="item in segment.items" ng-class="[item.segmentType, {\'highlighted\': (item.id === highlightedItem.id)}]" ng-mouseenter=onHoverEvent(item) ng-mouseleave=onHoverEvent() ng-click=onClickEvent(item)></div></div>'},function(e,t){e.exports='<div class=atp-container><div class=atp-head><div class=atp-row><div class="atp-cell atpr-title"><span class=atpc-label>{{locale.labels.rowTitle}}</span></div><div class="atp-cell atpr-timetable" ng-if=!options.disableTimetable><span class=atpc-label>{{locale.labels.timetableTitle}}</span></div><div class="atp-cell atpr-counter" ng-if=!options.disableCounter><span class=atpc-label>{{locale.labels.counterTitle.hours}}</span></div><div class="atp-cell atp-segment" ng-repeat="segment in segments" ng-class="{\'week-day-segment\': options.timeScope === \'week\',\n                      \'hour-segment\': options.timeScope === \'day\'}"><span class=atpc-label>{{segment.name}}</span></div></div></div><div class=atp-items-wrapper><div class=atp-row ng-repeat="row in rows" drop-channel="{{options.editable && row.editable && options.dropChannel}}" ui-on-drop="onDropEvent($data, row.id)" time-planner-row></div><current-time-marker class=atp-current-time-marker ng-if=!options.disableCurrentTimeMarker /></div></div>'},function(e,t){e.exports="<div class=\"atp-cell atpr-title\"><span class=atpc-label>{{row.title}}</span></div><div class=\"atp-cell atpr-timetable\" ng-if=!options.disableTimetable><span class=atpc-label>{{row.timetable.start ? row.timetable.start.join(':') + \" - \" + row.timetable.end.join(':') : 'N/A'}}</span></div><div class=\"atp-cell atpr-counter\" ng-if=options.needCounter><span class=atpc-label>{{row.hours || 0}}</span></div><div class=\"atp-cell atp-segment\" ng-repeat=\"segment in row.segments\" ng-class=\"{'week-day-segment': options.timeScope === 'week',\n                'hour-segment': options.timeScope === 'day',\n                'unavailable-segment': segment.disabled}\" time-planner-cell></div>"},function(e,t,n){function r(e){return n(a(e))}function a(e){var t=o[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var o={"./time-planner-locale_en-us":0,"./time-planner-locale_en-us.js":0};r.keys=function(){return Object.keys(o)},r.resolve=a,e.exports=r,r.id=15}])});
//# sourceMappingURL=angular-time-planner.min.js.map